#!/usr/local/bin/perl -w

# ident "@(#) $Header$"
# ident "@(#)        $Name$"

package BLM::Startup::Bedrock;

use strict;

BEGIN
{
    use Exporter ();
    use vars	qw ($VERSION @ISA);
    $VERSION	= do { my @r = (q$Revision$ =~ /\d+/g); sprintf "%d."."%02d" x $#r, @r };
}

use TagX::Log 1.01;
use SIS::Hash;
@ISA = qw(SIS::Hash);

sub TIEHASH
{
    my $class = shift;
    my $self = bless {}, $class;
    $self->{'version'} = $Text::TagX::VERSION;
    $self;
}

sub require_version
{
    my $self = shift;
    my $version = shift;
    die "Require version $version. This version is only $Text::TagX::VERSION\n"
	unless $Text::TagX::VERSION >= $version;
}

sub makeHash
{
    goto &new;
}

sub makeArray
{
    goto &newArray;
}

sub new
{
    my $self = shift;
    my $class = shift;
    &log_message( undef, "$self: creating an object of class $class" );
    $self->loadModule( $class );
    my $href = {};
    tie %{$href}, $class, @_;
    bless $href, $class;
}

sub newArray
{
    my $self = shift;
    my $class = shift;
    $self->loadModule( $class );
    my $aref = [];
    tie @{$aref}, $class, @_;
    bless $aref, $class;
}

sub loadModule
{
    my $self = shift;
    my @mods = @_;

    for my $class (@mods) {
	$class =~ s!::!/!g;
	$class =~ s!$!.pm! unless $class =~ /\.pm$/;
	next if $INC{$class};
	require $class;
	&log_message( undef, "$class loaded successfully" );
    }
}

sub reloadModule
{
    my $self = shift;
    my @mods = @_;

    for my $class (@mods) {
	$class =~ s!::!/!g;
	$class =~ s!$!.pm! unless $class =~ /\.pm$/;
	delete $INC{$class};
	require $class;
	&log_message( undef, "$class loaded successfully" );
    }
}

1;

#
# Name of Release: $Name$
# $Log$
# Revision 1.4  2000/06/26 14:00:09  sridhar
# 1. Added methods loadModule() and reloadModule() for loading modules
# on the fly.
# 2. Replaced FETCH with TIEHASH which initialized needed variables
# during construction
#
# Revision 1.3  2000/06/14 13:59:45  sridhar
# Added new() and newArray() as synonyms for makeHash() and makeArray().
#
# Revision 1.2  2000/06/07 18:35:21  sridhar
# Removed a debug log message
#
# Revision 1.1  2000/06/06 20:42:08  sridhar
# Bedrock loadable modules for startup
#
#
