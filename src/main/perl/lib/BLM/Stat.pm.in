#!/usr/local/bin/perl -w

# ident "@(#) $Header$"
# ident "@(#)        $Name$"

#
#    This file is a part of Bedrock, a server-side web scripting tool.
#    Check out http://www.openbedrock.org
#    Copyright (C) 2001, Charles Jones, LLC.
#
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program; if not, write to the Free Software
#    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
#

package BLM::Stat;

use strict;

BEGIN
{
    use Exporter ();
    use vars	qw ($VERSION @ISA);
    $VERSION	= 1.02;
}

use Bedrock::Hash;

@ISA = qw( Bedrock::Hash );

sub TIEHASH
{
    my $class = shift;
    $class = ref($class) || $class;
    my $file = shift;
    die "Usage: ". $class. "::new(file)\n" unless defined($file);
    my @l = stat($file);
    die $class . "::new(): unable to stat $file: $!\n" unless @l;
    my $self = bless Bedrock::Hash->new, $class;
    @{$self}{qw(dev ino mode nlink uid gid rdev size atime mtime ctime blksize blocks)} = @l;
    $self;
}

1;

#
# Name of Release: $Name$
# $Log$
# Revision 1.7  2009/12/30 12:39:36  rlauer
# updated docs
#
# Revision 1.6  2009/12/30 00:23:31  rlauer
# update docs for Bedrock II
#
# Revision 1.5  2009/12/28 23:32:18  rlauer
# add docs, fix die message
#
# Revision 1.4  2009/12/28 20:32:33  rlauer
# move SIS:: up to Bedrock::
#
# Revision 1.3  2008/12/03 14:01:19  alans
# We now use a hard-coded value for module $VERSION rather than a munged
# version of the expansion of the CVS 'Revision' keyword; the module API
# version number is orthogonal to the identifyer in the source control
# system.
#
# This change makes it safe to import the Bedrock codebase into another
# source repository (even CVS!) without breaking the code. We hit this
# issue when we first released the libbedrock-perl .deb package, for which
# we imported the release tarball sources into the 'bedrock-deb' CVS project.
#
# Revision 1.2  2001/02/14 15:35:44  sridhar
# Added copyright and GPL notice
#
# Revision 1.1  2000/09/29 19:12:53  sridhar
# We can stat files in the filesystem now.
#
#

=pod

=head1 NAME

C<BLM::Stat> -- Return info about a file.

=head1 SYNOPSIS

 <plugin:Stat $file>
 <var $Stat.size>

=head1 DESCRIPTION

Returns a 13 element hash of file statistics. From the perldocs...

I<Not all fields are supported on all filesystem types.  Here are the meanings of the fields:>

  dev      device number of filesystem
  ino      inode number
  mode     file mode  (type and permissions)
  nlink    number of (hard) links to the file
  uid      numeric user ID of file's owner
  gid      numeric group ID of file's owner
  rdev     the device identifier (special files only)
  size     total size of file, in bytes
  atime    last access time in seconds since the epoch
  mtime    last modify time in seconds since the epoch
  ctime    inode change time in seconds since the epoch (*)
  blksize  preferred block size for file system I/O
  blocks   actual number of blocks allocated

=head1 AUTHOR

J. Sridhar

=cut
